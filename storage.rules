rules_version = '2';

// DEVELOPMENT ONLY: Allows all authenticated users to read and write any file.
// Restrict this for production!
service firebase.storage {
  match /b/{bucket}/o {
    // Allow users to read/write their own files in storeItems
    match /storeItems/{userId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    // Allow authenticated users to read/write any file directly under storeItems (for compatibility with current upload path)
    match /storeItems/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow users to read/write their own files in storeBanners
    match /storeBanners/{userId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    // Allow users to read/write their own files in posts
    match /posts/{userId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    // Allow users to read/write their own files in userProfiles
    match /userProfiles/{userId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    // Allow authenticated users to upload refund transfer screenshots
    match /refund-screenshots/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload complaint screenshots
    match /complaint-screenshots/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload food hygiene proofs
    match /foodHygieneProofs/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload alcohol licenses
    match /alcoholLicenses/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload alcohol purchase ID verifications
    match /alcoholPurchaseIds/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload council registration forms
    match /councilRegistrations/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload store certificates
    match /storeCertificates/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload store food hygiene documents
    match /storeFoodHygiene/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload market stall licences
    match /storeMarketStallLicence/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Allow authenticated users to upload online business licences
    match /storeOnlineLicence/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    // Deny all other access
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
